(()=>{"use strict";const n=document.createElement("template");n.innerHTML='\n  <style>\n    :host {\n      display: block;\n      font-family: \'CiscoSans\', -apple-system, BlinkMacSystemFont, sans-serif;\n      font-size: 14px;\n      --primary: #1a8917;\n      --primary-light: #2db52a;\n      --primary-dark: #146611;\n      --success: #4CAF50;\n      --warning: #FF9800;\n      --error: #d32f2f;\n      --bg: #ffffff;\n      --bg-secondary: #f5f7fa;\n      --text: #1a1a1a;\n      --text-secondary: #666;\n      --border: #e0e0e0;\n    }\n    :host([dark-mode="true"]) {\n      --bg: #1a1a1a;\n      --bg-secondary: #2d2d2d;\n      --text: #f0f0f0;\n      --text-secondary: #aaa;\n      --border: #444;\n    }\n    * { box-sizing: border-box; }\n    .container {\n      background: var(--bg);\n      color: var(--text);\n      border-radius: 8px;\n      overflow: hidden;\n      border: 1px solid var(--border);\n    }\n    .header {\n      background: var(--primary);\n      color: white;\n      padding: 12px 16px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    .header-title {\n      font-weight: 600;\n      font-size: 15px;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n    .header-logo {\n      height: 24px;\n      width: auto;\n    }\n    .search-section {\n      padding: 16px;\n      background: var(--bg-secondary);\n      border-bottom: 1px solid var(--border);\n    }\n    .search-row {\n      display: flex;\n      gap: 8px;\n    }\n    .search-input {\n      flex: 1;\n      padding: 10px 12px;\n      border: 1px solid var(--border);\n      border-radius: 4px;\n      font-size: 14px;\n      background: var(--bg);\n      color: var(--text);\n    }\n    .search-input:focus {\n      outline: none;\n      border-color: var(--primary);\n    }\n    .btn {\n      padding: 10px 16px;\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: all 0.2s;\n    }\n    .btn-primary {\n      background: var(--primary);\n      color: white;\n    }\n    .btn-primary:hover { background: var(--primary-dark); }\n    .btn-primary:disabled {\n      background: #ccc;\n      cursor: not-allowed;\n    }\n    .btn-secondary {\n      background: transparent;\n      color: var(--primary);\n      border: 1px solid var(--primary);\n    }\n    .btn-secondary:hover { background: rgba(26,137,23,0.1); }\n    .btn-sm { padding: 6px 12px; font-size: 12px; }\n\n    /* Loading & States */\n    .loading, .error, .empty {\n      padding: 40px 20px;\n      text-align: center;\n      color: var(--text-secondary);\n    }\n    .spinner {\n      width: 32px;\n      height: 32px;\n      border: 3px solid var(--border);\n      border-top-color: var(--primary);\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n      margin: 0 auto 12px;\n    }\n    @keyframes spin { to { transform: rotate(360deg); } }\n    .error { color: var(--primary); }\n\n    /* Customer Profile */\n    .profile-section { padding: 16px; }\n    .customer-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n      margin-bottom: 16px;\n    }\n    .customer-name {\n      font-size: 18px;\n      font-weight: 600;\n      margin: 0 0 4px 0;\n    }\n    .customer-id {\n      font-size: 12px;\n      color: var(--text-secondary);\n    }\n    .member-badge {\n      background: var(--success);\n      color: white;\n      padding: 4px 10px;\n      border-radius: 12px;\n      font-size: 11px;\n      font-weight: 600;\n    }\n    .member-badge.freshpass {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    }\n\n    /* Points Card */\n    .points-card {\n      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);\n      color: white;\n      padding: 12px 16px;\n      border-radius: 8px;\n      margin-bottom: 16px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    .points-main {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    }\n    .points-label { font-size: 11px; opacity: 0.9; }\n    .points-value {\n      font-size: 28px;\n      font-weight: 700;\n      line-height: 1;\n    }\n    .points-expiry { font-size: 10px; opacity: 0.8; }\n    .points-stats {\n      display: flex;\n      gap: 16px;\n    }\n    .points-stat { text-align: center; }\n    .points-stat-value { font-size: 14px; font-weight: 600; }\n    .points-stat-label { font-size: 9px; opacity: 0.8; }\n\n    /* Info Grid */\n    .info-grid {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 12px;\n      margin-bottom: 16px;\n    }\n    .info-card {\n      background: var(--bg-secondary);\n      padding: 12px;\n      border-radius: 6px;\n    }\n    .info-card-label {\n      font-size: 11px;\n      color: var(--text-secondary);\n      margin-bottom: 4px;\n    }\n    .info-card-value { font-weight: 500; }\n\n    /* Tabs */\n    .tabs {\n      display: flex;\n      border-bottom: 1px solid var(--border);\n      background: var(--bg-secondary);\n    }\n    .tab {\n      flex: 1;\n      padding: 12px;\n      text-align: center;\n      cursor: pointer;\n      font-size: 13px;\n      font-weight: 500;\n      color: var(--text-secondary);\n      border-bottom: 2px solid transparent;\n      transition: all 0.2s;\n    }\n    .tab:hover { color: var(--text); }\n    .tab.active {\n      color: var(--primary);\n      border-bottom-color: var(--primary);\n    }\n    .tab-content { display: none; padding: 16px; }\n    .tab-content.active { display: block; }\n\n    /* Offers Section */\n    .offer-section-title {\n      font-size: 12px;\n      font-weight: 600;\n      color: var(--text-secondary);\n      text-transform: uppercase;\n      letter-spacing: 0.5px;\n      margin: 0 0 12px 0;\n      padding-bottom: 8px;\n      border-bottom: 1px solid var(--border);\n    }\n    .offer-section { margin-bottom: 20px; }\n    .offer-section:last-child { margin-bottom: 0; }\n\n    /* Rewards List */\n    .rewards-list { max-height: 280px; overflow-y: auto; }\n    .reward-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 12px;\n      margin-bottom: 8px;\n      background: var(--bg-secondary);\n      border-radius: 8px;\n      border: 1px solid var(--border);\n    }\n    .reward-item:last-child { margin-bottom: 0; }\n    .reward-icon {\n      width: 40px;\n      height: 40px;\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 18px;\n      margin-right: 12px;\n      flex-shrink: 0;\n    }\n    .reward-icon.grocery { background: rgba(0,82,159,0.1); }\n    .reward-icon.gas { background: rgba(255,152,0,0.1); }\n    .reward-icon.freeitem { background: rgba(76,175,80,0.1); }\n    .reward-info { flex: 1; }\n    .reward-name { font-weight: 600; margin-bottom: 2px; }\n    .reward-meta { font-size: 12px; color: var(--text-secondary); }\n    .reward-action {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-end;\n      gap: 4px;\n    }\n    .reward-points {\n      background: var(--primary);\n      color: white;\n      padding: 4px 10px;\n      border-radius: 12px;\n      font-size: 12px;\n      font-weight: 600;\n    }\n    .reward-btn {\n      padding: 6px 12px;\n      font-size: 11px;\n      border-radius: 4px;\n      cursor: pointer;\n      border: none;\n      background: var(--primary);\n      color: white;\n      font-weight: 500;\n    }\n    .reward-btn:hover { background: var(--primary-dark); }\n    .reward-btn.secondary {\n      background: transparent;\n      border: 1px solid var(--primary);\n      color: var(--primary);\n    }\n\n    /* Clipped Offers */\n    .clipped-offer {\n      display: flex;\n      align-items: center;\n      padding: 10px 12px;\n      background: var(--bg-secondary);\n      border-radius: 8px;\n      margin-bottom: 8px;\n      border: 1px solid var(--border);\n    }\n    .clipped-offer:last-child { margin-bottom: 0; }\n    .clipped-check {\n      width: 20px;\n      height: 20px;\n      background: var(--success);\n      color: white;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 12px;\n      margin-right: 10px;\n      flex-shrink: 0;\n    }\n    .clipped-info { flex: 1; }\n    .clipped-name { font-weight: 500; font-size: 13px; }\n    .clipped-brand { font-size: 11px; color: var(--text-secondary); }\n    .clipped-expires {\n      font-size: 11px;\n      color: var(--warning);\n      background: rgba(255,152,0,0.1);\n      padding: 2px 8px;\n      border-radius: 4px;\n    }\n\n    /* Transaction List */\n    .transaction-list { max-height: 280px; overflow-y: auto; }\n    .transaction-item {\n      display: flex;\n      justify-content: space-between;\n      padding: 12px;\n      margin-bottom: 8px;\n      background: var(--bg-secondary);\n      border-radius: 8px;\n      border: 1px solid var(--border);\n    }\n    .transaction-item:last-child { margin-bottom: 0; }\n    .transaction-icon {\n      width: 40px;\n      height: 40px;\n      background: rgba(0,82,159,0.1);\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 18px;\n      margin-right: 12px;\n      flex-shrink: 0;\n    }\n    .transaction-info { flex: 1; }\n    .transaction-store { font-weight: 600; margin-bottom: 2px; }\n    .transaction-date { font-size: 12px; color: var(--text-secondary); }\n    .transaction-details { text-align: right; }\n    .transaction-amount { font-weight: 600; font-size: 15px; }\n    .transaction-points { \n      font-size: 12px; \n      color: var(--success);\n      display: flex;\n      align-items: center;\n      justify-content: flex-end;\n      gap: 4px;\n    }\n    .transaction-items { font-size: 11px; color: var(--text-secondary); }\n\n    /* Actions */\n    .actions {\n      display: flex;\n      gap: 8px;\n      padding: 16px;\n      border-top: 1px solid var(--border);\n      flex-wrap: wrap;\n    }\n    .actions .btn { flex: 1; min-width: 120px; }\n\n    /* Quick Actions */\n    .quick-actions {\n      display: grid;\n      grid-template-columns: repeat(3, 1fr);\n      gap: 10px;\n      margin-bottom: 16px;\n    }\n    .quick-action {\n      background: var(--bg-secondary);\n      border: 1px solid var(--border);\n      border-radius: 8px;\n      padding: 16px 8px;\n      text-align: center;\n      cursor: pointer;\n      transition: all 0.2s;\n    }\n    .quick-action:hover {\n      border-color: var(--primary);\n      background: rgba(26,137,23,0.05);\n      transform: translateY(-2px);\n    }\n    .quick-action-icon { \n      font-size: 24px; \n      margin-bottom: 8px;\n      display: block;\n    }\n    .quick-action-label { \n      font-size: 11px; \n      font-weight: 500;\n      color: var(--text);\n    }\n\n    /* Action History */\n    .action-history { margin-top: 16px; }\n    .action-history-title {\n      font-size: 12px;\n      font-weight: 600;\n      color: var(--text-secondary);\n      text-transform: uppercase;\n      letter-spacing: 0.5px;\n      margin-bottom: 12px;\n    }\n    .action-log {\n      background: var(--bg-secondary);\n      border-radius: 8px;\n      padding: 12px;\n      max-height: 120px;\n      overflow-y: auto;\n      font-size: 12px;\n      border: 1px solid var(--border);\n    }\n    .action-log-item {\n      padding: 6px 0;\n      border-bottom: 1px solid var(--border);\n      display: flex;\n      justify-content: space-between;\n    }\n    .action-log-item:last-child { border-bottom: none; }\n    .action-log-type { font-weight: 500; }\n    .action-log-time { color: var(--text-secondary); }\n\n    /* Toggle Switch */\n    .toggle-row {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 12px;\n      background: var(--bg-secondary);\n      border-radius: 8px;\n      margin-bottom: 12px;\n      border: 1px solid var(--border);\n    }\n    .toggle-label { font-weight: 500; }\n    .toggle-desc { font-size: 11px; color: var(--text-secondary); }\n    .toggle-switch {\n      position: relative;\n      width: 44px;\n      height: 24px;\n      flex-shrink: 0;\n    }\n    .toggle-switch input { opacity: 0; width: 0; height: 0; }\n    .toggle-slider {\n      position: absolute;\n      cursor: pointer;\n      inset: 0;\n      background: #ccc;\n      border-radius: 24px;\n      transition: 0.3s;\n    }\n    .toggle-slider:before {\n      content: "";\n      position: absolute;\n      height: 18px;\n      width: 18px;\n      left: 3px;\n      bottom: 3px;\n      background: white;\n      border-radius: 50%;\n      transition: 0.3s;\n    }\n    .toggle-switch input:checked + .toggle-slider { background: var(--primary); }\n    .toggle-switch input:checked + .toggle-slider:before { transform: translateX(20px); }\n  </style>\n  \n  <div class="container">\n    <div class="header">\n      <div class="header-title">\n        <img src="https://storage.googleapis.com/gcp-wxcctoolkit-nprd-41927.appspot.com/assets/DwOVM0HYZPOjxemCLo1foEsxRmm1/ALB-forU-862w.png" alt="Albertsons for U" class="header-logo">\n      </div>\n      <button class="btn btn-sm" id="refreshBtn" style="background:rgba(255,255,255,0.2);color:white;border:none;">‚Üª</button>\n    </div>\n    \n    <div class="search-section">\n      <div class="search-row">\n        <input type="tel" class="search-input" id="phoneInput" placeholder="Enter phone number (ANI)" maxlength="14">\n        <button class="btn btn-primary" id="searchBtn">Search</button>\n      </div>\n    </div>\n    \n    <div id="content">\n      <div class="empty">\n        <p>Enter a phone number to look up customer rewards</p>\n      </div>\n    </div>\n  </div>\n';class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(n.content.cloneNode(!0)),this._customer=null,this._loading=!1,this._activeTab="overview",this._phoneInput=this.shadowRoot.getElementById("phoneInput"),this._searchBtn=this.shadowRoot.getElementById("searchBtn"),this._refreshBtn=this.shadowRoot.getElementById("refreshBtn"),this._content=this.shadowRoot.getElementById("content")}static get observedAttributes(){return["ani","dark-mode","interaction-id"]}connectedCallback(){this._searchBtn.addEventListener("click",()=>this._searchCustomer()),this._refreshBtn.addEventListener("click",()=>this._refresh()),this._phoneInput.addEventListener("keypress",n=>{"Enter"===n.key&&this._searchCustomer()}),this._phoneInput.addEventListener("input",n=>this._formatPhone(n)),this.dispatchEvent(new CustomEvent("widget-ready",{bubbles:!0,composed:!0}))}attributeChangedCallback(n,e,t){e!==t&&"ani"===n&&t&&(this._phoneInput.value=this._formatPhoneNumber(t),this._searchCustomer())}setANI(n){n&&(this._phoneInput.value=this._formatPhoneNumber(n),this._searchCustomer())}getCustomerData(){return this._customer}_formatPhone(n){let e=n.target.value.replace(/\D/g,"");e.length>10&&(e=e.slice(0,10)),e.length>=6?e=`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6)}`:e.length>=3&&(e=`(${e.slice(0,3)}) ${e.slice(3)}`),n.target.value=e}_formatPhoneNumber(n){const e=n.replace(/\D/g,"").slice(-10);return 10===e.length?`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6)}`:n}async _searchCustomer(){const n=this._phoneInput.value.replace(/\D/g,"");if(10===n.length){this._setLoading(!0);try{const e=await this._fetchCustomerData(n);this._customer=e,this._renderCustomer(),this.dispatchEvent(new CustomEvent("customer-loaded",{bubbles:!0,composed:!0,detail:{customer:e,phone:n}}))}catch(n){this._showError(n.message||"Failed to load customer data")}finally{this._setLoading(!1)}}else this._showError("Please enter a valid 10-digit phone number")}async _fetchCustomerData(n){await new Promise(n=>setTimeout(n,800));const e=n.slice(-4);return{id:`ALB-${e}${Date.now().toString().slice(-4)}`,phone:n,firstName:"Sarah",lastName:"Johnson",email:`sjohnson${e}@email.com`,memberSince:"2021-03-15",tier:Math.random()>.5?"FreshPass":"Standard",points:{current:Math.floor(2e3*Math.random())+500,expiring:Math.floor(300*Math.random()),expiryDate:this._getNextMonth(),lifetimeEarned:Math.floor(15e3*Math.random())+5e3,lifetimeRedeemed:Math.floor(1e4*Math.random())+2e3},rewards:{birthdayTreat:{available:!0,expiresOn:"2025-12-31"},freeMonthlyItem:{available:!0,item:"O Organics¬Æ Milk",expiresOn:"2025-12-31"},gasRewards:{centsOff:30,gallonsRemaining:25}},recentTransactions:[{date:"2025-12-08",store:"Albertsons #1234",amount:87.42,pointsEarned:87,items:12},{date:"2025-12-05",store:"Albertsons #1234",amount:45.18,pointsEarned:45,items:6},{date:"2025-12-01",store:"Albertsons #5678",amount:123.67,pointsEarned:124,items:18},{date:"2025-11-28",store:"Albertsons #1234",amount:67.89,pointsEarned:68,items:9},{date:"2025-11-24",store:"Albertsons #5678",amount:234.56,pointsEarned:235,items:32}],clippedOffers:[{id:"off1",name:"$2 off Cheerios",brand:"General Mills",expires:"2025-12-15",clipped:!0},{id:"off2",name:"BOGO Lucerne Milk",brand:"Lucerne",expires:"2025-12-20",clipped:!0},{id:"off3",name:"$5 off $25 Deli Purchase",brand:"Store",expires:"2025-12-31",clipped:!0}],availableOffers:[{id:"rwd1",name:"$4 off Purchase",points:300,type:"grocery",description:"Any grocery purchase"},{id:"rwd2",name:"$8 off Purchase",points:600,type:"grocery",description:"Any grocery purchase"},{id:"rwd3",name:"$15 off Purchase",points:1e3,type:"grocery",description:"Any grocery purchase"},{id:"rwd4",name:"10¬¢ off/gallon",points:100,type:"gas",description:"Up to 25 gallons"},{id:"rwd5",name:"20¬¢ off/gallon",points:200,type:"gas",description:"Up to 25 gallons"},{id:"rwd6",name:"Free O Organics Item",points:400,type:"freeitem",description:"Select items up to $6"}],preferences:{autoCashOff:!1,smsOptIn:!0,emailOptIn:!0}}}_getNextMonth(){const n=new Date;return n.setMonth(n.getMonth()+1),n.toISOString().split("T")[0]}_setLoading(n){this._loading=n,this._searchBtn.disabled=n,n&&(this._content.innerHTML='\n        <div class="loading">\n          <div class="spinner"></div>\n          <p>Looking up customer...</p>\n        </div>\n      ')}_showError(n){this._content.innerHTML=`\n      <div class="error">\n        <p>‚ö†Ô∏è ${n}</p>\n        <button class="btn btn-secondary btn-sm" onclick="this.getRootNode().host._resetView()">Try Again</button>\n      </div>\n    `}_resetView(){this._customer=null,this._content.innerHTML='\n      <div class="empty">\n        <p>Enter a phone number to look up customer rewards</p>\n      </div>\n    '}_refresh(){this._customer&&this._searchCustomer()}_renderCustomer(){const n=this._customer,e="FreshPass"===n.tier;this._content.innerHTML=`\n      <div class="profile-section">\n        <div class="customer-header">\n          <div>\n            <h2 class="customer-name">${n.firstName} ${n.lastName}</h2>\n            <div class="customer-id">ID: ${n.id} ‚Ä¢ Member since ${new Date(n.memberSince).toLocaleDateString()}</div>\n          </div>\n          <span class="member-badge ${e?"freshpass":""}">${n.tier}${e?" ¬Æ":""}</span>\n        </div>\n        \n        <div class="points-card">\n          <div class="points-main">\n            <div>\n              <div class="points-label">Available Points</div>\n              <div class="points-value">${n.points.current.toLocaleString()}</div>\n              <div class="points-expiry">${n.points.expiring} expiring ${n.points.expiryDate}</div>\n            </div>\n          </div>\n          <div class="points-stats">\n            <div class="points-stat">\n              <div class="points-stat-value">${(n.points.lifetimeEarned/1e3).toFixed(1)}k</div>\n              <div class="points-stat-label">Earned</div>\n            </div>\n            <div class="points-stat">\n              <div class="points-stat-value">${n.rewards.gasRewards.centsOff}¬¢</div>\n              <div class="points-stat-label">Gas</div>\n            </div>\n          </div>\n        </div>\n        \n        <div class="info-grid">\n          <div class="info-card">\n            <div class="info-card-label">Phone</div>\n            <div class="info-card-value">${this._formatPhoneNumber(n.phone)}</div>\n          </div>\n          <div class="info-card">\n            <div class="info-card-label">Email</div>\n            <div class="info-card-value">${n.email}</div>\n          </div>\n          <div class="info-card">\n            <div class="info-card-label">Birthday Treat</div>\n            <div class="info-card-value">${n.rewards.birthdayTreat.available?"‚úì Available":"Redeemed"}</div>\n          </div>\n          <div class="info-card">\n            <div class="info-card-label">Free Monthly Item</div>\n            <div class="info-card-value">${n.rewards.freeMonthlyItem.available?"‚úì Available":"Redeemed"}</div>\n          </div>\n        </div>\n      </div>\n      \n      <div class="tabs">\n        <div class="tab active" data-tab="offers">Offers</div>\n        <div class="tab" data-tab="transactions">Transactions</div>\n        <div class="tab" data-tab="actions">Actions</div>\n      </div>\n      \n      <div class="tab-content active" data-tab="offers">\n        <div class="offer-section">\n          <div class="offer-section-title">üéÅ Points Rewards (${n.points.current} pts available)</div>\n          <div class="rewards-list">\n            ${n.availableOffers.map(e=>`\n              <div class="reward-item">\n                <div class="reward-icon ${e.type}">\n                  ${"gas"===e.type?"‚õΩ":"freeitem"===e.type?"üéÅ":"üõí"}\n                </div>\n                <div class="reward-info">\n                  <div class="reward-name">${e.name}</div>\n                  <div class="reward-meta">${e.description}</div>\n                </div>\n                <div class="reward-action">\n                  <span class="reward-points">${e.points} pts</span>\n                  <button class="reward-btn ${n.points.current>=e.points?"":"secondary"}" \n                          data-reward-id="${e.id}" \n                          ${n.points.current<e.points?"disabled":""}>\n                    ${n.points.current>=e.points?"Redeem":"Need "+(e.points-n.points.current)}\n                  </button>\n                </div>\n              </div>\n            `).join("")}\n          </div>\n        </div>\n        \n        <div class="offer-section">\n          <div class="offer-section-title">‚úÇÔ∏è Clipped Digital Coupons (${n.clippedOffers.length})</div>\n          ${n.clippedOffers.map(n=>`\n            <div class="clipped-offer">\n              <div class="clipped-check">‚úì</div>\n              <div class="clipped-info">\n                <div class="clipped-name">${n.name}</div>\n                <div class="clipped-brand">${n.brand}</div>\n              </div>\n              <div class="clipped-expires">Exp ${new Date(n.expires).toLocaleDateString()}</div>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n      \n      <div class="tab-content" data-tab="transactions">\n        <div class="offer-section-title">üìã Recent Purchases</div>\n        <div class="transaction-list">\n          ${n.recentTransactions.map(n=>`\n            <div class="transaction-item">\n              <div class="transaction-icon">üßæ</div>\n              <div class="transaction-info">\n                <div class="transaction-store">${n.store}</div>\n                <div class="transaction-date">${new Date(n.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}</div>\n                <div class="transaction-items">${n.items} items</div>\n              </div>\n              <div class="transaction-details">\n                <div class="transaction-amount">${n.amount.toFixed(2)}</div>\n                <div class="transaction-points">\n                  <span>+${n.pointsEarned}</span>\n                  <span>pts</span>\n                </div>\n              </div>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n      \n      <div class="tab-content" data-tab="actions">\n        <div class="offer-section-title">‚ö° Quick Actions</div>\n        <div class="quick-actions">\n          <div class="quick-action" data-action="add-points">\n            <span class="quick-action-icon">‚ûï</span>\n            <span class="quick-action-label">Add Points</span>\n          </div>\n          <div class="quick-action" data-action="adjust-points">\n            <span class="quick-action-icon">‚úèÔ∏è</span>\n            <span class="quick-action-label">Adjust Points</span>\n          </div>\n          <div class="quick-action" data-action="manual-redeem">\n            <span class="quick-action-icon">üéÅ</span>\n            <span class="quick-action-label">Manual Redeem</span>\n          </div>\n          <div class="quick-action" data-action="link-accounts">\n            <span class="quick-action-icon">üîó</span>\n            <span class="quick-action-label">Link Accounts</span>\n          </div>\n          <div class="quick-action" data-action="update-profile">\n            <span class="quick-action-icon">üë§</span>\n            <span class="quick-action-label">Edit Profile</span>\n          </div>\n          <div class="quick-action" data-action="send-offers">\n            <span class="quick-action-icon">üìß</span>\n            <span class="quick-action-label">Email Offers</span>\n          </div>\n        </div>\n        \n        <div class="toggle-row">\n          <div>\n            <div class="toggle-label">Auto Cash Off</div>\n            <div class="toggle-desc">Convert 100 pts to $1 at checkout</div>\n          </div>\n          <label class="toggle-switch">\n            <input type="checkbox" id="autoCashOffToggle" ${n.preferences.autoCashOff?"checked":""}>\n            <span class="toggle-slider"></span>\n          </label>\n        </div>\n        \n        <div class="toggle-row">\n          <div>\n            <div class="toggle-label">SMS Notifications</div>\n            <div class="toggle-desc">Receive deals via text message</div>\n          </div>\n          <label class="toggle-switch">\n            <input type="checkbox" id="smsToggle" ${n.preferences.smsOptIn?"checked":""}>\n            <span class="toggle-slider"></span>\n          </label>\n        </div>\n        \n        <div class="action-history">\n          <div class="action-history-title">üìù Session Activity</div>\n          <div class="action-log" id="actionLog">\n            <div class="action-log-item">\n              <span class="action-log-type">Customer loaded</span>\n              <span class="action-log-time">${(new Date).toLocaleTimeString()}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class="actions">\n        <button class="btn btn-primary" id="copyInfoBtn">Copy Info</button>\n        <button class="btn btn-secondary" id="openPortalBtn">Open Portal</button>\n      </div>\n    `,this._attachEventListeners()}_attachEventListeners(){this.shadowRoot.querySelectorAll(".tab").forEach(n=>{n.addEventListener("click",()=>{this.shadowRoot.querySelectorAll(".tab").forEach(n=>n.classList.remove("active")),this.shadowRoot.querySelectorAll(".tab-content").forEach(n=>n.classList.remove("active")),n.classList.add("active"),this.shadowRoot.querySelector(`.tab-content[data-tab="${n.dataset.tab}"]`).classList.add("active")})}),this.shadowRoot.querySelectorAll(".quick-action").forEach(n=>{n.addEventListener("click",()=>{this._logAction(n.dataset.action),this.dispatchEvent(new CustomEvent("widget-action",{bubbles:!0,composed:!0,detail:{action:n.dataset.action,customer:this._customer}}))})}),this.shadowRoot.querySelectorAll(".reward-btn:not([disabled])").forEach(n=>{n.addEventListener("click",()=>{const e=n.dataset.rewardId,t=this._customer.availableOffers.find(n=>n.id===e);t&&(this._logAction(`Redeem: ${t.name}`),this.dispatchEvent(new CustomEvent("redeem-reward",{bubbles:!0,composed:!0,detail:{reward:t,customer:this._customer}})))})}),this.shadowRoot.getElementById("autoCashOffToggle")?.addEventListener("change",n=>{this._customer.preferences.autoCashOff=n.target.checked,this._logAction("Auto Cash Off: "+(n.target.checked?"ON":"OFF")),this.dispatchEvent(new CustomEvent("preference-changed",{bubbles:!0,composed:!0,detail:{preference:"autoCashOff",value:n.target.checked,customer:this._customer}}))}),this.shadowRoot.getElementById("smsToggle")?.addEventListener("change",n=>{this._customer.preferences.smsOptIn=n.target.checked,this._logAction("SMS Notifications: "+(n.target.checked?"ON":"OFF")),this.dispatchEvent(new CustomEvent("preference-changed",{bubbles:!0,composed:!0,detail:{preference:"smsOptIn",value:n.target.checked,customer:this._customer}}))}),this.shadowRoot.getElementById("copyInfoBtn")?.addEventListener("click",()=>{const n=this._customer,e=`Customer: ${n.firstName} ${n.lastName}\nID: ${n.id}\nPhone: ${n.phone}\nPoints: ${n.points.current}\nTier: ${n.tier}`;navigator.clipboard.writeText(e),this._logAction("Copied customer info"),this.dispatchEvent(new CustomEvent("info-copied",{bubbles:!0,composed:!0}))}),this.shadowRoot.getElementById("openPortalBtn")?.addEventListener("click",()=>{this._logAction("Opened portal"),this.dispatchEvent(new CustomEvent("open-portal",{bubbles:!0,composed:!0,detail:{url:"https://www.albertsons.com/customer-account/rewards",customer:this._customer}}))})}_logAction(n){const e=this.shadowRoot.getElementById("actionLog");if(e){const t=document.createElement("div");t.className="action-log-item",t.innerHTML=`\n        <span class="action-log-type">${n}</span>\n        <span class="action-log-time">${(new Date).toLocaleTimeString()}</span>\n      `,e.insertBefore(t,e.firstChild)}}}customElements.define("albertsons-rewards-widget",e)})();